<!doctype html>
<html lang="en-us">

<head></head>

<body>
    <script type="text/javascript">
        async function setupAndRun() {
            const { default: createVggWasmInstance } = await import('./sut/vgg_runtime.mjs');
            createVggWasmInstance({
                locateFile: function (path, prefix) {
                    if (path.endsWith('.data')) {
                        return './sut/' + path;
                    }
                    return prefix + path;
                },
            }).then(async function (myInstance) {
                try {
                    myInstance._emscripten_main();
                } catch (error) {
                    console.error(error);
                }

                // Given
                const { getVggSdk, setVgg } = await import("https://s5.vgg.cool/vgg-sdk.esm.js");
                setVgg(myInstance);

                const vggSdk = await getVggSdk();
                // When
                const documentString = vggSdk.getDesignDocument();
                // Then
                console.log("document json string from sdk is: ", documentString);
            });
        }

        setupAndRun();

        function vggAssert(condition, message) {
            if (!condition) {
                throw new Error(message || "Assertion failed");
            }
        }

    </script>
</body>

</html>